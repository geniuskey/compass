# 픽셀 해부학

하나의 픽셀을 따라 여행을 떠나봅시다 -- 빛이 들어오는 맨 위부터 빛이 전기 신호로 변환되는 맨 아래까지.

최신 스마트폰 카메라 센서에는 수백만 개의 픽셀이 들어 있으며, 각 픽셀은 정밀하게 설계된 광학 및 전자 층(layer)들의 적층 구조입니다. 모든 층에는 고유한 역할이 있습니다: 빛을 굴절시키거나, 색상을 필터링하거나, 반사를 줄이거나, 광자(photon)를 전자(electron)로 변환합니다. 이 적층 구조를 이해하는 것이 이미지 센서 시뮬레이션을 이해하는 첫걸음이자, 시뮬레이션이 왜 중요한지를 이해하는 출발점입니다.

<PixelAnatomyViewer />

이 페이지에서는 **BSI(Back-Side Illuminated, 이면 조사)** 픽셀 구조를 위에서 아래로 살펴보겠습니다. BSI는 현대 센서에서 지배적인 구조인데, 배선층을 실리콘 뒤쪽에 배치하여 빛이 광검출기(photodetector)까지 방해 없이 도달할 수 있기 때문입니다. 손님을 초대하기 전에 복도의 장애물을 치우는 것과 같다고 생각하면 됩니다.

BSI가 표준이 되기 전에는 센서가 **FSI(Front-Side Illuminated, 전면 조사)** 구조를 사용했습니다. FSI에서는 빛이 실리콘에 도달하기 전에 금속 배선층과 유전체 막을 통과해야 했습니다. 이는 숲 캐노피를 통해 빗물을 받으려는 것과 같았습니다 -- 상당량의 빛이 위쪽 배선에 의해 차단되거나 산란되었습니다. 2000년대 후반 BSI로의 전환은 이미지 센서 역사상 가장 중요한 발전 중 하나였으며, 양자 효율(Quantum Efficiency)을 즉시 15-20 퍼센트 포인트 향상시켰습니다.

규모를 가늠해 보면: 최신 스마트폰의 전형적인 픽셀은 약 0.7 ~ 1.0 마이크로미터 폭입니다. 이는 사람 머리카락 굵기의 대략 1/100입니다. 마이크로렌즈 꼭대기부터 실리콘 바닥까지의 전체 광학 적층 구조는 약 5 ~ 10 마이크로미터 높이에 불과합니다. 그러나 그 작은 부피 안에서 빛은 집속되고, 색상별로 필터링되고, 반사 방지 코팅되고, 흡수되어 전기 전하로 변환됩니다. 지금까지 설계된 가장 조밀하게 집적된 광학 시스템 중 하나입니다.

---

## 층 적층 구조(Layer Stack)

픽셀은 하나의 단일한 "물체"가 아닙니다 -- 마이크로미터의 수분의 1 단위로 측정되는 박막(thin film)과 구조물의 적층체입니다. 전체 적층 높이는 일반적으로 5-10 마이크로미터로, 이는 사람 머리카락 굵기의 약 1/10입니다. 빛이 하늘에서 센서 내부로 들어가는 경로를 따라가며 각 층을 만나봅시다.

<StackVisualizer />

#### default_bsi_1um 픽셀 단면도

아래 인터랙티브 뷰어는 기본 BSI 1µm 픽셀(`default_bsi_1um.yaml`)의 정밀한 2D 단면을 보여줍니다. XZ, YZ, XY 평면을 전환하여 모든 레이어, 하위 구조(DTI, 금속 격자, BARL 서브레이어, 포토다이오드), 초타원 마이크로렌즈 프로파일을 탐색하세요.

<PixelCrossSections />

#### 3D 픽셀 구조

드래그하여 등각(isometric) 3D 뷰를 회전하세요. 분해도(Exploded View)를 토글하여 레이어를 분리하거나, 개별 레이어를 숨겨 내부 구조를 확인할 수 있습니다.

<Pixel3DViewer />

### 1. 공기(Air) -- 빛이 도달하는 곳

모든 것은 열린 공기 중에서 시작됩니다. 장면으로부터의 빛 -- 얼굴에서 반사된 햇빛이든, 가로등의 빛이든 -- 은 전자기파의 형태로 센서 표면에 도달합니다.

이 시점에서 빛은 모든 색상(파장)이 혼합된 상태입니다. 그 빛 중 적절한 부분만을 분류하고, 집속하고, 측정하는 것이 픽셀의 역할입니다.

공기에서 첫 번째 고체 층으로의 전환은 이미 중요합니다. 빛이 한 물질에서 다른 물질로 넘어갈 때마다 일부가 반사됩니다. 두 물질의 광학적 성질 차이가 클수록 반사가 강해집니다. 유리창에서 반사가 보이는 이유가 바로 이것이며, 센서 설계자들이 픽셀 적층 구조의 모든 계면에서 반사를 최소화하기 위해 노력하는 이유이기도 합니다.

카메라에서 픽셀 위의 "공기"는 실제로 카메라 모듈 렌즈 시스템의 마지막 요소와 센서 표면 사이의 공간입니다. 스마트폰에서 이 간격은 일반적으로 1밀리미터 미만입니다. 각 픽셀에 도달하는 빛의 품질 -- 각도, 강도, 균일성 -- 은 위쪽의 카메라 광학 시스템 전체에 의해 결정됩니다.

공기에서 고체로의 전환의 한 가지 중요한 특성은 프레넬 반사(Fresnel reflection)입니다. 수직 입사(빛이 정면으로 부딪힘)의 경우, 공기-폴리머 계면에서의 반사는 약 4%입니다. 작아 보이지만 기억하세요: 반사된 모든 광자는 이미지에 기여하지 못하는 광자입니다. 수백만 개의 픽셀과 수십억 개의 광자에 걸쳐 4%는 측정 가능한 감도 손실로 합산됩니다.

빛이 도달하는 각도도 크게 중요합니다. 센서 중앙에서 빛은 거의 수직으로 들어옵니다. 가장자리와 모서리에서는 빛이 법선에서 20-35도 각도로 도달할 수 있습니다. 이 경사 입사는 적층 구조의 모든 층과 빛의 상호작용을 변화시킵니다 -- 각 층을 통과하는 유효 경로 길이가 증가하고, 회절 각도가 변하며, 반사 계수가 이동합니다. 수직 입사에서 잘 작동하는 픽셀 설계가 큰 각도에서는 성능이 저하될 수 있으며, 그 반대도 마찬가지입니다. 이 각도 의존성은 픽셀 최적화가 어려운 이유 중 하나이며, 임의의 입사 각도를 처리하는 시뮬레이션 도구가 필수적인 이유입니다.

### 2. 마이크로렌즈(Microlens) -- 초소형 집속 렌즈

각 픽셀 위에는 투명한 폴리머(감광제 기반 수지 등)로 만들어진 초소형 렌즈가 있습니다. 이 마이크로렌즈는 놀라울 정도로 작아서, 보통 픽셀 자체의 폭과 비슷하며 최신 센서에서는 약 1 마이크로미터 이하인 경우가 많습니다.

**왜 필요한가?**

마이크로렌즈가 없으면, 들어오는 빛의 상당 부분이 픽셀 사이의 틈 -- 금속 격자, 격리 구조, 또는 인접 픽셀 위 -- 에 떨어져 낭비됩니다. 마이크로렌즈는 빗물을 양동이로 모아주는 깔때기와 같은 역할을 합니다. 픽셀 전체 면적에 걸쳐 빛을 모아 중앙의 활성 검출 영역으로 집속시킵니다.

그 개선 효과는 상당합니다. 잘 설계된 마이크로렌즈는 평면 픽셀 표면에 비해 포토다이오드에 도달하는 빛의 양을 30-50% 증가시킬 수 있습니다. 작은 픽셀(1.5 마이크로미터 이하)에서 마이크로렌즈는 단순히 도움이 되는 것이 아니라 필수적입니다. 마이크로렌즈 없이는 저조도에서 픽셀이 거의 사용 불가능할 수 있습니다.

**형상과 프로파일**

마이크로렌즈는 완벽한 반구가 아닙니다. 그 형상은 일반적으로 "초타원(superellipse)" 프로파일로 기술됩니다 -- 높이, 곡률 반경, 형상 지수 등의 매개변수를 조절하여 튜닝할 수 있는 부드러운 돔 형태의 곡선입니다. 둥근 렌즈는 더 강하게 집속하고, 평평한 렌즈는 더 완만하게 빛을 굴절시킵니다. 센서 설계자는 픽셀 크기와 상부 카메라 모듈의 광학 특성에 가장 잘 맞는 프로파일을 선택합니다.

인접 마이크로렌즈 사이의 간격도 중요합니다. 이상적으로는 마이크로렌즈가 표면을 완벽하게 타일링하여 간격 없이 모든 입사 광자를 포획해야 합니다. 실제로는 경계에 항상 작은 틈이 있습니다. 현대 제조 기술은 마이크로렌즈 "충진율(fill factor)"을 95% 이상으로 높여, 픽셀 면적의 5% 미만만이 미피복 상태입니다.

::: details 수학적 표현 (Math Detail)
초타원 프로파일은 다음과 같이 주어집니다:

z(r) = h * (1 - (r/R)^2)^(1/(2a))

여기서 h는 렌즈 높이, R은 반경, r은 중심으로부터의 반경 방향 거리, a는 형상 매개변수입니다. a = 1이면 표준 타원체로 환원됩니다. a < 1은 가파른 가장자리를 가진 더 "각진" 렌즈 형상을, a > 1은 더 뾰족한 프로파일을 만듭니다.
:::

**CRA 시프트(Chief Ray Angle Shift): 센서 가장자리의 편심 렌즈**

센서 중앙에 도달하는 빛은 거의 수직(표면에 수직)으로 들어옵니다. 하지만 센서 모서리에서는 빛이 비스듬하게 도달하는데, 이 각도를 주광선 각도(Chief Ray Angle, CRA)라고 합니다. 전형적인 스마트폰 카메라에서 CRA는 센서 모서리에서 25-35도에 달할 수 있습니다.

이를 보상하기 위해 센서 가장자리의 마이크로렌즈는 의도적으로 중심에서 벗어나게 배치됩니다. 렌즈를 센서 중앙 쪽으로 약간 이동시켜, 비스듬하게 들어오는 빛도 아래의 포토다이오드(photodiode)에 정확히 집속되도록 합니다. 이 시프트가 없으면 모서리 픽셀은 훨씬 적은 빛을 받게 되어 사진의 가장자리가 어두워집니다(이를 "비네팅(vignetting)" 또는 "셰이딩(shading)"이라 합니다).

이 시프트는 센서 전체에 걸쳐 부드럽게 변화합니다 -- 중앙에서는 0이고 모서리에서 최대입니다. 시프트 거리는 일반적으로 픽셀 피치의 일부입니다. COMPASS에서는 CRA를 지정하면 시뮬레이션이 자동으로 이 오프셋을 고려하여, 각 픽셀 위치에 맞게 마이크로렌즈 위치를 조정합니다.

### 3. 평탄화층(Planarization Layer) -- 표면을 매끄럽게

마이크로렌즈와 아래의 컬러 필터 사이에는 일반적으로 0.1 ~ 0.5 마이크로미터 두께의 얇은 평탄화층이 있습니다. 이 층의 역할은 간단하지만 필수적입니다: 마이크로렌즈가 안착할 평평하고 매끄러운 표면을 제공하는 것입니다.

아래의 컬러 필터층은 격자 구조로 되어 있어 약간의 높이 변화와 필터 사이의 간격이 있습니다. 이 고르지 않은 표면 위에 직접 마이크로렌즈를 형성하면 렌즈 형상이 왜곡되어 집속 성능이 저하됩니다. 수십 나노미터 수준의 작은 표면 불균일도 렌즈 프로파일을 충분히 악화시켜 QE를 측정 가능한 수준으로 저하시킬 수 있습니다.

평탄화층은 이러한 간격을 채우고 균일한 기반을 만듭니다. 일반적으로 투명하고 낮은 굴절률의 재료(주로 스핀온 폴리머 또는 산화물)로 만들어집니다. 울퉁불퉁한 표면 위에 투명한 수지를 얇게 부어 매끄럽게 만든 후 그 위에 렌즈를 올리는 것과 같다고 생각하면 됩니다.

광학적 역할은 크지 않습니다 -- 투명하고 강한 반사를 일으키지 않는 굴절률을 가지면 됩니다. 하지만 두께를 정확하게 맞추는 것은 마이크로렌즈와 컬러 필터 사이의 거리를 제어하는 데 중요하며, 이는 집속된 빛의 원뿔이 필터에 어떻게 도달하는지에 영향을 미칩니다. 너무 두꺼우면 초점이 최적 위치 아래로 이동합니다. 너무 얇으면 표면이 충분히 매끄러워지지 않을 수 있습니다.

일부 고급 설계에서 평탄화층은 반사 방지 시스템의 일부 역할도 합니다. 마이크로렌즈 재료와 컬러 필터 재료 사이의 중간 굴절률을 선택함으로써, 이 계면에서의 반사를 줄이는 데 도움이 될 수 있습니다 -- QE의 모든 퍼센트 포인트가 중요한 상황에서 작지만 의미 있는 개선입니다.

### 4. 컬러 필터 배열(Color Filter Array, CFA) -- 각 픽셀에 색상 정체성 부여

여기서 픽셀이 "색상"을 갖게 됩니다. 디지털 카메라 센서는 본질적으로 색맹입니다 -- 실리콘은 모든 가시광 파장을 흡수하며 빨강과 파랑을 구분할 수 없습니다. 색상 정보는 전적으로 각 픽셀 위에 놓인 필터에서 나옵니다.

**베이어 패턴(Bayer Pattern)**

가장 일반적인 컬러 필터 배열은 1976년 코닥의 Bryce Bayer가 발명한 베이어 패턴입니다: 빨강, 초록, 초록, 파랑(RGGB)의 반복되는 2x2 격자입니다. 센서의 작은 부분을 보면 다음과 같습니다:

```
 G  R  G  R  G  R
 B  G  B  G  B  G
 G  R  G  R  G  R
 B  G  B  G  B  G
```

왜 초록이 둘이고 빨강과 파랑은 하나씩일까요? 인간의 시각 체계가 초록빛에 가장 민감하기 때문입니다. 인간의 눈은 초록/휘도 정보에 대해 빨강이나 파랑에 비해 대략 두 배의 공간 해상도를 가지고 있습니다. 초록 픽셀이 두 배로 있으면 더 나은 체감 선명도와 휘도 정확도를 제공합니다. 각 픽셀에 누락된 색상 정보는 나중에 디모자이킹(demosaicing)이라는 과정 -- 이웃 픽셀을 기반으로 각 픽셀 위치의 전체 RGB 값을 추정하는 알고리즘 -- 을 통해 채워집니다.

다른 컬러 필터 패턴도 존재합니다 -- 쿼드 베이어(Quad Bayer, 같은 색상 픽셀의 2x2 그룹), RYYB(초록 대신 노랑을 사용하여 감도 향상), 자동차 또는 머신 비전용 특수 패턴 등. 하지만 표준 베이어 RGGB가 여전히 가장 일반적입니다.

**필터의 작동 원리**

각 컬러 필터는 본질적으로 염료 또는 안료 재료의 얇은 층으로, 일반적으로 0.5 ~ 1.0 마이크로미터 두께입니다. 빨간 필터는 파란색과 초록색 빛을 흡수하면서 빨간 파장을 투과시킵니다. 파란 필터는 빨간색과 초록색을 흡수합니다. 초록 필터는 빨간색과 파란색을 흡수합니다.

핵심 통찰은 필터링이 곧 흡수라는 것입니다. 원치 않는 파장은 통과하여 사라지는 것이 아니라 필터 재료에 흡수되어 열로 변환됩니다. 이것이 컬러 픽셀의 양자 효율이 결코 100%에 도달할 수 없는 이유 중 하나입니다: 필터 자체가 들어오는 빛의 상당 부분을 제거합니다.

최대 투과 파장에서도 어떤 필터도 완벽하게 투명하지 않습니다. 전형적인 초록 필터는 550 nm에서 85-90%의 빛을 투과시킬 수 있는데, 이는 "올바른" 색상도 필터에서 10-15%가 손실된다는 뜻입니다.

**필터 사이의 금속 격자(Metal Grid)**

인접한 컬러 필터 사이에는 일반적으로 약 0.1 ~ 0.3 마이크로미터 폭의 얇은 금속 격자(주로 텅스텐 또는 알루미늄)가 있습니다. 이 격자는 광학 장벽 역할을 합니다 -- 하나의 컬러 필터를 통과한 빛이 옆으로 새어 다른 색상 필터를 가진 인접 픽셀로 들어가는 것을 방지합니다.

이 격자가 없으면, 빨간 필터를 통과한 빨간 광자가 옆으로 산란되어 이웃한 초록 픽셀에서 검출될 수 있습니다. 이러한 유형의 광학적 누화(optical crosstalk)는 색상 정확도와 화질을 저하시킵니다. 금속 격자는 아파트 사이의 벽과 같아서, 각 픽셀의 빛을 해당 영역 안에 가두어 둡니다.

격자에는 트레이드오프가 있습니다: 빛을 모을 수 있는 공간을 차지합니다. 1 마이크로미터 픽셀에서 네 면에 각 100 나노미터 폭의 격자는 픽셀 면적의 약 19%를 소비합니다. 이것이 마이크로렌즈가 중요한 또 다른 이유입니다 -- 마이크로렌즈가 빛을 이러한 사각지대에서 벗어나 중앙으로 집속시킵니다.

금속 격자의 높이와 재료도 성능에 영향을 미칩니다. 더 높은 격자는 경사진 빛을 더 많이 차단하지만 회절 효과도 증가시킵니다. 더 낮은 격자는 더 많은 누출을 허용하지만 덜 회절합니다. 격자 재료의 반사율도 중요합니다 -- 높은 반사율의 격자는 빛을 단순히 흡수하는 대신 올바른 픽셀로 반사시켜 "손실된" 광자의 일부를 회수할 수 있습니다. 격자 치수 최적화는 다변수 문제이며, COMPASS는 격자를 전체 전자기 시뮬레이션의 일부로 모델링하여 이를 처리합니다.

### 5. 하부 반사 방지층(BARL, Bottom Anti-Reflection Layer) -- 계면 반사 감소

빛이 컬러 필터를 빠져나와 아래의 실리콘으로 들어갈 때, 큰 굴절률 변화를 만나게 됩니다. 공기의 굴절률은 1.0, 일반적인 필터 재료는 약 1.5-1.7, 실리콘은 가시광 파장에서 약 4.0입니다. ~1.6에서 ~4.0으로의 이 도약은 상당한 반사를 일으킵니다 -- 수면을 볼 때 강한 반사가 보이는 것과 비슷하지만, 훨씬 더 심합니다.

BARL은 이 반사를 줄이기 위해 설계된 박막 적층(thin-film stack)입니다. 안경이나 카메라 렌즈의 반사 방지 코팅과 같은 원리로 작동합니다.

**작동 원리**

BARL은 일반적으로 높은 굴절률과 낮은 굴절률 재료의 교대 층으로 구성됩니다 -- 예를 들어, 산화하프늄(HfO2, n ~ 2.0)과 이산화규소(SiO2, n ~ 1.46). 각 층은 극도로 얇으며, 대략 30-80 나노미터 수준입니다. 각 층의 두께를 신중하게 선택함으로써, 설계자는 투과광에 대한 보강 간섭(constructive interference)과 반사광에 대한 상쇄 간섭(destructive interference)을 만듭니다.

간단히 말해: BARL은 저굴절률 필터에서 고굴절률 실리콘으로의 광학적 전환을 완화하는 "구배(gradient)"를 만듭니다. 큰 반사를 일으키는 하나의 급격한 도약 대신, 빛이 여러 작은 도약을 거치게 되어 부분적으로 서로 상쇄되는 훨씬 작은 반사들이 발생합니다.

단일층 ARC는 하나의 특정 파장에 대해 최적화할 수 있습니다. 하지만 픽셀은 넓은 파장 범위(위의 컬러 필터의 전체 대역)에서 작동해야 합니다. 2-4개의 교대 막으로 이루어진 다층 설계는 가시광 스펙트럼 전체에 걸쳐 우수한 반사 방지 성능을 제공하지만, 제조 복잡도가 증가합니다.

::: details 수학적 표현 (Math Detail)
단일층 반사 방지 코팅의 이상적인 굴절률은:

n_ARC = sqrt(n1 * n2)

여기서 n1과 n2는 주변 층의 굴절률입니다. 이상적인 두께는 목표 파장을 ARC 굴절률로 나눈 값의 1/4입니다(1/4파장 조건):

d = lambda / (4 * n_ARC)

다층 설계는 이 원리를 확장하여 더 넓은 파장 범위를 커버하며, 전달 행렬 방법(transfer matrix method)을 사용하여 층 두께를 동시에 최적화합니다.
:::

**왜 중요한가**

BARL이 없으면, 실리콘 계면에서의 반사로 컬러 필터를 통과한 빛의 30% 이상이 낭비될 수 있습니다. 잘 설계된 BARL로 반사 손실을 목표 파장 범위 전체에서 몇 퍼센트 수준으로 줄일 수 있습니다. QE 최적화에서 이 층의 설계를 제대로 하는 것이 가장 큰 영향을 미치는 요소 중 하나입니다 -- BARL 층 두께의 작은 변화(5-10 나노미터 수준)도 QE를 몇 퍼센트 포인트 이동시킬 수 있습니다.

### 6. 실리콘 기판(Silicon Substrate) -- 광자가 전자로 변하는 곳

여기가 픽셀의 핵심입니다. 위의 모든 층은 빛을 여기로 전달하기 위해 존재합니다. 실리콘 기판은 실제 검출이 이루어지는 곳입니다 -- 광자가 흡수되어 전자-정공 쌍(electron-hole pair)을 생성하고, 이것이 수집되어 측정됩니다.

**포토다이오드(Photodiode)**

실리콘 내부에는 포토다이오드가 내장되어 있습니다 -- 서로 다르게 도핑된 실리콘 영역 사이의 접합(junction, 일반적으로 p-n 접합)입니다. 이 접합 내부 또는 근처에서 광자가 흡수되면 자유 전자(와 대응하는 "정공")가 생성됩니다. 접합 영역의 전기장이 이 캐리어(carrier)들을 분리하고 전자를 수집하여 픽셀의 신호 전하에 추가합니다.

포토다이오드는 전체 실리콘 체적을 차지하지 않습니다. 이것은 정의된 영역으로, 일반적으로 실리콘의 상부(BSI 소자에서 빛이 들어오는 쪽)에 집중되어 있습니다. 포토다이오드의 깊이와 횡방향 범위가 "수집 체적(collection volume)"을 결정합니다 -- 생성된 전자가 포획될 확률이 높은 영역입니다.

포토다이오드 영역에서 흡수되는 광자가 많을수록 신호가 커집니다. 이것이 양자 효율이 측정하는 핵심입니다.

**흡수 깊이와 파장**

실리콘은 모든 파장을 동일하게 흡수하지 않습니다. 이것은 픽셀 물리학에서 가장 중요한 개념 중 하나입니다:

- **파란빛 (450 nm)**: 매우 빠르게 흡수되어, 표면에서 약 0.2 마이크로미터 이내에 흡수됩니다. 거의 모든 파란 광자가 매우 얇은 층에서 포획됩니다. 이것이 얇은 실리콘도 파란빛에는 잘 작동하는 이유입니다.
- **초록빛 (550 nm)**: 약 1-2 마이크로미터 이내에 흡수됩니다. 빠른 흡수와 적절한 실리콘 두께 사이의 좋은 균형점입니다. 실리콘 이미징의 "최적점(sweet spot)"입니다.
- **빨간빛 (650 nm)**: 대부분 흡수되려면 약 3 마이크로미터 이상의 실리콘이 필요합니다. 빨간 광자는 포획되기 전에 더 깊이 침투합니다. 3 마이크로미터 실리콘 층은 650 nm 빛의 약 60%를 흡수하고, 5 마이크로미터는 약 80%를 포획합니다.
- **근적외선 (850 nm 이상)**: 수 마이크로미터의 실리콘을 전혀 흡수되지 않고 통과할 수 있습니다. 많은 NIR 광자는 검출되지 않은 채 픽셀 아래쪽으로 빠져나갑니다. 850 nm에서 실리콘의 흡수 길이는 약 20 마이크로미터로, 전형적인 픽셀보다 훨씬 두껍습니다.

이것이 실리콘 두께가 중요한 설계 매개변수인 이유입니다. 더 두꺼운 실리콘은 더 많은 빨강 및 NIR 빛을 포획하지만, 비용이 더 들고 누화(crosstalk)가 증가할 수 있습니다 (깊이 이동하는 광자는 인접 픽셀로 옆으로 표류할 기회가 더 많습니다).

::: details 수학적 표현 (Math Detail)
흡수는 베어-램버트 법칙(Beer-Lambert's law)을 따릅니다:

I(z) = I0 * exp(-alpha * z)

여기서 alpha는 실리콘의 흡수 계수이며, 파장에 강하게 의존합니다. 450 nm에서 alpha ~ 3.5 x 10^4 /cm. 550 nm에서 alpha ~ 7 x 10^3 /cm. 650 nm에서 alpha ~ 3 x 10^3 /cm -- 파란빛보다 10배 이상 작습니다. 흡수 깊이(1/alpha)는 빛의 ~63%가 흡수되는 두께를 나타냅니다.
:::

**DTI (Deep Trench Isolation, 딥 트렌치 격리)**

인접 픽셀 사이에 깊고 좁은 트렌치가 실리콘에 식각되어 절연 재료(주로 이산화규소)로 채워집니다. 이 트렌치는 전면에서 실리콘 깊숙이까지 -- 때로는 웨이퍼 전체 두께(2-6 마이크로미터)를 관통하여 -- 연장됩니다.

DTI는 두 가지 목적을 제공합니다:

1. **광학적 격리**: 트렌치 벽은 실리콘(n ~ 4.0)과 산화물(n ~ 1.46) 사이의 큰 굴절률 차이로 인해 거울 역할을 하여, 인접 픽셀로 새어 나갈 빛을 올바른 픽셀로 다시 반사합니다. 실리콘-산화물 계면에서의 반사율은 50%를 초과할 수 있어, DTI 벽은 효과적인 광 도파관(light guide) 역할을 합니다. 이것은 광학적 누화를 극적으로 줄입니다.

2. **전기적 격리**: 절연 충전재가 한 픽셀에서 생성된 전자가 이웃 픽셀의 포토다이오드로 확산되는 것을 방지합니다. DTI가 없으면 픽셀 경계 근처에서 생성된 전자는 어느 쪽 픽셀에서든 수집될 확률이 거의 동일합니다 -- 50%의 누화 확률입니다.

최신 센서는 트렌치가 실리콘 전체를 관통하는 "풀 DTI"(FDTI)를 사용하여 픽셀 간 완전한 격리를 만듭니다. 부분 DTI(실리콘 일부까지만 연장)는 이전 세대에서 사용되었으며 하부에서의 누출을 여전히 허용합니다. 부분 DTI에서 풀 DTI로의 전환은 소형 픽셀 화질 향상을 위한 가장 중요한 혁신 중 하나였습니다.

전형적인 DTI 트렌치는 50-150 나노미터 폭으로, 수 마이크로미터 깊이일 수 있다는 점을 고려하면 놀라울 정도로 좁습니다. 종횡비(깊이 대 폭)가 30:1을 초과할 수 있어, DTI 제조는 센서 제작에서 가장 도전적인 단계 중 하나입니다.

광학적 반사와 전기적 격리의 조합은 DTI를 현대 픽셀 설계에서 가장 중요한 구조적 혁신으로 만듭니다. DTI가 보편화되기 전에는 인접 픽셀 간의 누화가 허용 가능한 화질을 유지하면서 픽셀을 얼마나 작게 만들 수 있는지를 제한하는 주요 요인 중 하나였습니다.

---

## 빛이 픽셀을 통과하는 방법

이제 모든 층을 알았으니, 하나의 광자가 완전한 여행을 하는 과정을 추적해 봅시다:

1. **도달**: 광자가 카메라 렌즈에서 출발하여 센서 표면을 향해 아래쪽으로 이동합니다. 픽셀이 센서 가장자리 근처에 있으면 광자는 비스듬한 각도(주광선 각도)로 도달합니다. 광자는 특정 파장 -- 예를 들어 550 nm(초록) -- 을 가지고 있습니다.

2. **마이크로렌즈 굴절**: 광자가 마이크로렌즈의 곡면에 부딪혀 안쪽으로 굴절됩니다. 렌즈 형상이 광자를 픽셀 중앙으로 집속합니다. CRA 오프셋이 있는 경우, 시프트된 렌즈가 입사 각도를 보정합니다. 광자의 궤적이 원래 방향에서 포토다이오드를 향한 더 수직적인 경로로 바뀝니다.

3. **평탄화층 통과**: 광자가 평탄화층을 통과합니다. 여기서는 광학적으로 크게 일어나는 일이 없습니다 -- 매끄럽고 투명한 통과 영역입니다. 광자는 마이크로렌즈 굴절에 의해 설정된 경로를 계속 따릅니다.

4. **컬러 필터**: 광자가 컬러 필터에 도달합니다.
   - 광자의 파장이 필터 색상과 맞으면 (예: 초록 필터에 550 nm 광자), 적당한 흡수를 거쳐 통과합니다 -- 약 10-15%가 손실될 수 있습니다.
   - 파장이 맞지 않으면 (예: 빨간 필터에 450 nm 파란 광자), 광자는 필터에 흡수되어 에너지가 미량의 열로 변환됩니다. 광자의 여행은 여기서 끝납니다.

5. **반사 방지층**: 살아남은 광자가 BARL을 통과합니다. 코팅이 이 파장에 맞게 잘 설계되어 있으면 광자는 최소한의 반사로 투과합니다. 소수의 광자(2-5%)가 이 계면에서 위쪽으로 반사되어 손실됩니다.

6. **실리콘 진입**: 광자가 실리콘에 들어갑니다. 이제 파장에 따라 무슨 일이 일어나는지가 결정됩니다.
   - 파란 광자는 마이크로미터의 수분의 1 이내에 거의 즉시 흡수됩니다.
   - 초록 광자는 약 1 마이크로미터를 이동한 후 흡수됩니다.
   - 빨간 광자는 3 마이크로미터 이상을 이동한 후 흡수될 수 있습니다.
   - NIR 광자는 흡수되지 않고 실리콘 전체를 통과할 수 있습니다.

7. **전자 생성**: 광자가 흡수되면, 그 에너지가 실리콘 결정 내의 전자에 전달되어 원자 결합에서 해방시킵니다. 이것이 전자-정공 쌍을 만듭니다. 이것이 포토다이오드의 수집 영역 내에서 일어나면, 전기장이 전자를 전하 저장 노드로 이동시키고, 다른 수집된 전자들과 합류합니다. 전자가 포획되어 신호의 일부가 됩니다.

8. **신호 읽출**: 노출 기간(수 밀리초에서 수 초)이 끝나면, 축적된 전하가 픽셀의 트랜지스터 회로에 의해 읽히고, 전압으로 변환되고, 아날로그-디지털 변환기에 의해 디지털화되어 이미지 프로세서로 전송됩니다. 수집된 전자의 수는 해당 픽셀에서의 빛의 세기에 비례합니다.

이 전체 여정 -- 마이크로렌즈에 도달하는 광자부터 포토다이오드에서 수집되는 전자까지 -- 은 적층 구조를 통해 빛의 속도로 일어납니다. 광학적 통과 시간은 대략 30 펨토초(30 x 10^-15초)입니다. 광자의 관점에서 이것은 본질적으로 순간적입니다. 하지만 그 통과 중에 발생하는 파동 광학 효과들 -- 간섭, 회절, 각 계면에서의 반사 -- 이 종합적으로 광자가 검출되는지 손실되는지를 결정합니다. 이것이 정확한 전자기 시뮬레이션이 중요한 이유입니다.

---

## 무엇이 잘못될 수 있는가

픽셀 적층 구조는 종이 위에서는 단순해 보일 수 있지만, 성능을 저하시킬 수 있는 많은 요소가 있습니다. 이러한 실패 모드를 이해하는 것은 픽셀 최적화의 핵심이며, COMPASS 시뮬레이션이 밝혀내는 내용을 이해하는 데 중심이 됩니다.

### 광학적 누화(Optical Crosstalk)

누화는 하나의 픽셀을 위한 빛이 인접 픽셀에서 검출되는 현상입니다. 여러 메커니즘이 있습니다:

- **컬러 필터 수준의 광학적 누화**: 빛이 하나의 필터를 통과한 후 실리콘에 들어가기 전에 옆으로 산란됩니다. 금속 격자가 도움이 되지만, 특히 가파른 각도로 도달하는 빛에 대해서는 이를 완전히 제거할 수 없습니다. 격자 가장자리에서의 회절이 빛을 측방향으로 재향시킬 수 있습니다.
- **실리콘 내 광학적 누화**: 광자가 올바른 픽셀로 들어가지만 실리콘 깊은 곳에서 흡수되어, 생성된 전자가 옆으로 확산되어 이웃 픽셀의 포토다이오드에 들어갑니다. 이것은 깊이 침투한 후 흡수되는 빨강 및 NIR 광자에서 특히 문제가 됩니다. DTI가 이에 대한 주요 방어 수단입니다.
- **회절(diffraction)에 의한 누화**: 픽셀 크기가 빛의 파장에 근접하면 회절 효과가 중요해집니다. 빛이 구조물의 가장자리에서 휘어져 물리적 장벽과 관계없이 인접 픽셀로 퍼질 수 있습니다. 이것은 엔지니어링으로 제거할 수 없는 근본적인 파동 광학 효과이며, 관리만 가능합니다.

누화는 색상 정확도와 이미지 선명도를 저하시킵니다. 일부 초록빛을 검출하는 빨간 픽셀이나 일부 파란빛을 검출하는 초록 픽셀은 잘못된 색상 측정값을 생성하며, 이미지 처리 파이프라인이 이를 보정해야 합니다. 과도한 보정은 잡음을 증폭시키므로, 광학 수준에서 누화를 최소화하는 것이 항상 바람직합니다.

최신 센서에서 전형적인 누화값은 잘 최적화된 설계에서 최인접 픽셀에 대해 1-3%, 도전적인 조건(작은 픽셀, 큰 CRA, 긴 파장)에서는 5-10% 이상입니다.

### 반사 손실(Reflection Losses)

굴절률이 다른 층 사이의 모든 계면에서 일부 반사가 발생합니다. 전형적인 픽셀 적층 구조에서는 이러한 계면이 5개 이상 있습니다. 반사 방지 조치가 없으면 누적 반사 손실로 들어오는 빛의 20-40%가 낭비될 수 있습니다.

BARL이 가장 큰 단일 반사(실리콘 계면)를 다루지만, 마이크로렌즈 표면, 필터 계면 및 기타 경계에서의 반사도 모두 기여합니다. 각 계면이 단지 2-4%만 반사하더라도, 5개의 계면이 합쳐지면 상당한 총 손실이 됩니다.

적층 구조를 최적화하는 것은 가장 큰 것만이 아니라 모든 계면에서의 반사를 최소화하는 것을 의미합니다. 이는 가능한 곳에서 인접 층 사이의 굴절률을 매칭시키고, 큰 인덱스 불일치가 불가피한 곳에서는 반사 방지 코팅을 사용하는 것을 포함합니다.

### 회절 효과(Diffraction Effects)

픽셀 피치(pixel pitch)가 약 1.5 마이크로미터 이하로 줄어들면 회절이 지배적인 광학 효과가 됩니다. 픽셀 개구(aperture)가 가시광의 파장(0.4-0.7 마이크로미터)과 비슷해지며, 빛은 더 이상 적층 구조를 통해 깔끔한 직선으로 이동하지 않습니다.

대신, 전자기파가 작은 개구(금속 격자의 틈 등)를 통과하거나 구조물(DTI 벽 등) 주위에서 퍼져나갑니다. 이러한 퍼짐은 의도된 픽셀 경계 밖으로 빛 에너지를 밀어내어 누화에 기여하고 유효 수집 면적을 줄입니다.

회절은 빨간빛보다 파란빛에 더 많이 영향을 미칩니다(짧은 파장은 주어진 개구 크기에 대해 더 넓은 각도로 회절됩니다). 이것은 다소 반직관적입니다. 0.7 마이크로미터 픽셀에서 파란빛(450 nm)은 회절의 심각한 영향을 받는 반면, 빨간빛(650 nm)은 다소 덜 영향을 받지만 면역은 아닙니다.

회절을 정확하게 시뮬레이션하려면 RCWA나 FDTD 같은 파동 광학(wave-optics) 솔버가 필요합니다 -- 이 규모에서는 단순한 광선 추적(ray tracing)으로는 충분하지 않습니다. 이것이 COMPASS와 같은 도구의 핵심 동기 중 하나입니다. 광선 기반 모델은 2 마이크로미터 이하 픽셀 동작을 지배하는 간섭 및 회절 효과를 포착하지 못합니다.

### 흡수 비효율(Absorption Inefficiency)

모든 파장이 실리콘에서 효율적으로 흡수되는 것은 아닙니다. 근적외선 광자(800 nm 이상)는 완전한 흡수를 위해 매우 두꺼운 실리콘층이 필요합니다. 실리콘을 더 두껍게 만들면 비용, 공정 복잡도, 누화 위험이 증가하므로 항상 실용적인 한계가 있습니다.

실리콘을 통과하며 흡수되지 않은 광자는 단순히 손실됩니다 -- 센서 뒷면을 빠져나가 신호에 전혀 기여하지 않습니다. 가시광 촬영에서 이것은 주로 깊은 빨강 파장에서의 문제입니다. NIR 응용(얼굴 인식, 거리 센싱, 야간 투시)에서는 흡수 비효율이 성능을 제한하는 지배적 요인입니다.

일부 고급 설계는 광 포획(light-trapping) 구조 -- 텍스처 표면이나 내장 반사기 -- 를 사용하여 빛을 실리콘 내부에서 다시 반사시켜 다중 내부 반사를 통해 효과적인 광학 경로 길이를 두 배로 늘립니다. 이러한 기술은 NIR 최적화 센서에서 특히 중요합니다.

### 미광과 플레어(Stray Light and Flare)

위의 메커니즘 외에도, 픽셀 적층 구조 내의 미광(stray light)이 성능을 저하시킬 수 있습니다. 실리콘 표면에서 반사되어 위쪽으로 이동하는 빛은 컬러 필터나 금속 격자의 하부에서 재반사되어 실리콘으로 돌아올 수 있습니다 -- 잠재적으로 다른 픽셀에서. 이러한 다중 반사 경로는 단순한 모델로 예측하기 어렵고 정확한 파동 광학 시뮬레이션이 필요합니다.

미광은 미묘한 아티팩트를 만들 수 있습니다: 약간 상승된 배경 신호, 감소된 대비, 색상 틴팅. 이러한 효과는 픽셀 단위에서는 작을 수 있지만, 이미지 전체에 걸쳐 축적되면 높은 다이내믹 레인지 장면에서 눈에 보일 수 있습니다.

### 편광 효과(Polarization Effects)

작은 픽셀 크기에서 픽셀 적층 구조는 빛의 서로 다른 편광(전자기파 진동의 방향)에 대해 다르게 반응할 수 있습니다. 금속 격자와 DTI 트렌치 같은 구조는 한 편광을 다른 편광보다 우선적으로 투과하거나 반사할 수 있어, 편광 의존적 QE로 이어집니다. 이것은 종종 작은 효과이지만 큰 입사 각도에서 더 뚜렷해지며 센서 전체의 공간적 비균일성에 기여할 수 있습니다.

---

## BSI vs. FSI: 구조가 왜 중요한가

이 페이지 전체에서 BSI 구조를 다루었지만, BSI가 FSI를 대체한 이유를 간략히 이해하는 것이 좋습니다.

**FSI(Front-Side Illuminated, 전면 조사)** 센서에서는 트랜지스터, 금속 배선, 층간 유전체가 모두 입사광과 같은 쪽에 있습니다. 광자는 실리콘에 도달하기 전에 여러 금속층(빛을 차단하고 산란시킴)과 유전체 적층을 통과해야 합니다. 금속 배선이 픽셀 면적의 상당 부분을 차지하여 광학적 사각지대를 만듭니다.

**BSI(Back-Side Illuminated, 이면 조사)** 센서에서는 제조 후 실리콘 웨이퍼를 뒤집습니다. 빛은 뒷면(배선이 없는)에서 들어오고, 트랜지스터와 금속은 반대쪽에 있어 빛의 경로에서 벗어납니다. 빛이 실리콘에 도달하기 전에 만나는 구조물은 우리가 설명한 광학 층들뿐입니다: 마이크로렌즈, 평탄화층, 컬러 필터, BARL.

그 이점은 극적입니다. BSI 픽셀은:
- 동등한 FSI 픽셀보다 30-50% 높은 QE
- 픽셀 면적 전체에 걸친 더 균일한 광 수집
- 큰 주광선 각도에서의 더 나은 성능
- 금속 라우팅의 더 큰 자유도(배선이 더 이상 광 수집과 경쟁하지 않으므로)

오늘날 사실상 모든 스마트폰 센서와 대부분의 고성능 이미징 센서는 BSI 기술을 사용합니다. 남아있는 FSI 응용은 주로 BSI의 웨이퍼 박화(wafer-thinning) 공정이 필요한 센서 특성과 호환되지 않는 특수 영역 -- 특정 과학 이미징이나 방사선 강화 센서 등 -- 에 한정됩니다.

BSI의 이점을 이해하는 것은 COMPASS 시뮬레이션의 중요한 맥락입니다: COMPASS에서 픽셀 적층 구조를 정의할 때, BSI가 가능하게 한 깨끗한 광학 경로를 기술하는 것입니다. 시뮬레이션은 빛의 경로에 있는 금속 라우팅이나 배선층을 모델링할 필요가 없는데, BSI가 이를 빛의 경로 밖으로 이동시켰기 때문입니다.

BSI 구조는 또한 시뮬레이션 기하학을 단순화합니다. 광학 경로에 의도적으로 설계된 층들(마이크로렌즈, 평탄화층, 컬러 필터, BARL, 실리콘, DTI)만 포함되므로, 구조는 RCWA 솔버에 잘 적합한 깨끗한 주기성을 가집니다. FSI 픽셀에서는 불규칙한 금속 라우팅이 이 주기성을 깨뜨려 시뮬레이션을 상당히 더 복잡하게 만들 것입니다.

---

## 시뮬레이션과의 연결

위에서 설명한 모든 층은 COMPASS YAML 구성 파일의 섹션에 직접 대응됩니다. 시뮬레이션을 정의할 때, 다음을 지정하게 됩니다:

- **마이크로렌즈**: 형상, 높이, 반경, 재료, CRA 오프셋
- **평탄화층**: 두께, 재료
- **컬러 필터**: 두께, 재료(분광 투과율을 인코딩), 금속 격자 치수 및 재료
- **BARL**: 층 수, 각 층의 두께, 재료
- **실리콘**: 두께, 포토다이오드 깊이, DTI 치수 및 재료

COMPASS는 이 층별 기술(description)을 가져와 PixelStack이라는 완전한 광학 모델을 구성합니다. 그런 다음 하나 이상의 전자기 솔버(RCWA, FDTD)에 이 모델을 전달하여 빛이 전체 적층 구조를 통해 어떻게 전파되는지 계산합니다.

결과는 픽셀 내 모든 지점에서 빛에 어떤 일이 일어나는지 정확히 알려줍니다: 각 층에서 얼마나 반사되고, 얼마나 흡수되고, 얼마나 포토다이오드에 도달하고, 얼마나 이웃 픽셀로 새는지. 이것이 다음 페이지에서 살펴볼 양자 효율 계산의 기초입니다.

시뮬레이션의 강점은 어떤 매개변수든 변경할 수 있다는 것입니다 -- 마이크로렌즈를 더 높게 만들거나, BARL 층을 추가하거나, DTI를 넓히고 -- 그 효과를 QE와 누화에서 즉시 확인할 수 있습니다. 센서의 물리적 프로토타이핑은 수개월이 걸리고 수백만 달러가 들지만, 시뮬레이션은 컴퓨팅 시간 외에는 비용이 들지 않으며 수 분이면 됩니다.

또한 COMPASS는 같은 픽셀 구조를 여러 독립적인 솔버(RCWA의 경우 torcwa, grcwa, meent, FDTD의 경우 flaport)로 실행하고 결과를 비교할 수 있습니다. 이 교차 검증은 시뮬레이션된 수치가 특정 수치 방법의 아티팩트가 아니라 물리적으로 의미 있다는 확신을 줍니다.

COMPASS를 사용할 때, 매개변수를 반복적으로 조정하는 경우가 많을 것입니다. 예를 들어, 기준 픽셀을 설정한 다음 마이크로렌즈 높이를 스위프하여 최적값을 찾고, 그 마이크로렌즈 구성에 맞춰 BARL 층 두께를 최적화하는 식입니다. 각 층은 다른 층과 상호작용하므로, 하나의 층을 최적화하면 다른 층의 최적 매개변수가 이동할 수 있습니다. COMPASS의 스위프 및 비교 러너(runner)는 이 반복적 워크플로우를 효율적으로 만들도록 설계되었습니다.

---

## 요약

현대 BSI 픽셀은 정밀하게 설계된 광학 적층 구조입니다:

| 층 | 전형적인 두께 | 주요 역할 |
|---|---|---|
| 공기(Air) | -- | 빛이 도달하는 매질 |
| 마이크로렌즈(Microlens) | 0.3 - 0.8 um | 활성 영역으로 빛 집속 |
| 평탄화층(Planarization) | 0.1 - 0.5 um | 마이크로렌즈를 위한 매끄러운 표면 제공 |
| 컬러 필터(Color Filter) | 0.5 - 1.0 um | 파장 대역 선택 (R, G, 또는 B) |
| 금속 격자(Metal Grid) | 0.1 - 0.3 um 폭 | 필터 간 빛 누출 차단 |
| BARL | 0.05 - 0.2 um 총 두께 | 실리콘 계면에서의 반사 감소 |
| 실리콘(Silicon) | 2 - 6 um | 광자 흡수 및 전자 생성 |
| DTI | 전체 깊이, 50-150 nm 폭 | 픽셀의 광학적/전기적 격리 |

각 층은 굴절, 흡수, 반사, 회절을 통해 빛과 상호작용합니다. 이러한 상호작용이 파장, 각도, 픽셀 기하학에 따라 어떻게 변하는지 이해하는 것이 바로 픽셀 시뮬레이션의 핵심입니다.

이 표의 두께 값은 대표적인 범위입니다. 실제 치수는 제조사, 픽셀 크기, 대상 응용에 따라 다릅니다. COMPASS는 특정 설계의 정확한 치수를 지정할 수 있게 합니다.

전체 픽셀 적층 구조는 놀라울 정도로 컴팩트한 광학 시스템입니다. 단 5-10 마이크로미터의 높이에서 집속, 색상 필터링, 반사 방지, 광자 흡수, 캐리어 수집을 수행합니다 -- 전통적인 광학에서는 수 센티미터의 공간이 필요한 기능들입니다. 각 층을 정확히 만들고, 모든 층이 조화롭게 함께 작동하도록 하는 것이 픽셀 공학의 핵심 도전입니다.

마지막으로, 실제 센서는 이러한 픽셀 수백만 개가 주기적 배열로 나란히 밀집되어 있음을 기억하세요. 각 픽셀의 전자기적 행동은 이웃에 의해 영향을 받습니다 -- RCWA 솔버가 활용하는 주기적 경계 조건은 단순한 수학적 편의가 아니라 물리적 현실의 반영입니다. 한 픽셀에서 회절된 빛은 인접 픽셀의 빛과 간섭할 수 있으며, 배열의 집단적 행동은 단일 격리된 픽셀에 대해 계산하는 것과 다릅니다. 이것이 COMPASS가 단일 픽셀을 격리하여 시뮬레이션하지 않고 주기적 경계를 가진 단위 셀(unit cell)을 시뮬레이션하는 이유입니다.

단일 픽셀의 해부학 -- 각 층이 무엇을 하는지, 왜 거기 있는지, 빛과 어떻게 상호작용하는지 -- 을 이해하는 것은 시뮬레이션 결과를 해석하고, 성능 문제를 진단하고, 더 나은 픽셀을 설계하는 기반을 제공합니다. 모든 최적화는 구조의 이해에서 시작됩니다.

**다음**: [양자 효율 이해하기](./qe-intuitive.md) -- 이 픽셀 적층 구조가 실제로 얼마나 잘 작동하는지 수치화합니다.
